{% extends "base.html" %}
{% set active_page = 'profile' %}

{% block title %}Editar Usuário{% endblock %}
{% block header_title %}Editar Usuário{% endblock %}

{% block content %}
<div class="container my-4">
    <div class="row">
        <!-- Coluna da Avatar -->
        <div class="col-md-4 d-flex justify-content-center align-items-start">
            <div class="text-center p-3" style="max-width:320px; width:100%;">
                <!-- SVG de usuário bonito (sem opção de upload) -->
                <div class="mb-3 d-flex justify-content-center">
                    <svg width="160" height="160" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Avatar">
                        <rect width="24" height="24" rx="6" fill="#f1f3f5"></rect>
                        <path d="M12 11.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7z" fill="#d1d5db"/>
                        <path d="M4 20c0-3.3137 2.6863-6 6-6h4c3.3137 0 6 2.6863 6 6v0H4z" fill="#e6e9ec"/>
                        <path d="M8 18c0-2.2091 1.7909-4 4-4s4 1.7909 4 4" stroke="#9aa3ad" stroke-width="0.8" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>

                <h5 class="mb-1">{{ user.username }}</h5>
                <p class="text-muted mb-0">{{ user.email }}</p>
            </div>
        </div>

        <!-- Coluna do Form -->
        <div class="col-md-8">
            <div class="card p-4">
                <form action="{{ url_for('Index.user_edit', user_id=user.id) }}" method="POST" novalidate>
                    <!-- Se estiver usando Flask-WTF inclua o CSRF token aqui -->
                    {% if csrf_token %}
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    {% endif %}

                    <div class="mb-3">
                        <label for="name" class="form-label">Nome</label>
                        <input id="name" name="name" type="text" class="form-control" value="{{ request.form.username or user.username }}" required>
                    </div>

                    <div class="mb-3">
                        <label for="email" class="form-label">E-mail</label>
                        <input id="email" name="email" type="email" class="form-control" value="{{ request.form.email or user.email }}" required>
                    </div>

                    <div class="mb-3">
                        <label for="bio" class="form-label">Bio (opcional)</label>
                        <textarea id="bio" name="bio" class="form-control" rows="4">{{ request.form.bio or user.bio or '' }}</textarea>
                    </div>

                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary">Salvar alterações</button>
                        <a href="{{ request.referrer or url_for('Index.dashboard') }}" class="btn btn-outline-secondary">Cancelar</a>
                    </div>

                    {% if flash_messages %}
                        <div class="mt-3">
                            {% for cat, msgs in flash_messages.items() %}
                                {% for msg in msgs %}
                                    <div class="alert alert-{{ 'success' if cat == 'success' else 'danger' }}" role="alert">{{ msg }}</div>
                                {% endfor %}
                            {% endfor %}
                        </div>
                    {% endif %}
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
