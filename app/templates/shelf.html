{% extends "base.html" %}
{% set active_page = 'shelf' %}

{% block title %}Book Nook{% endblock %}
{% block header_title %}My Shelf{% endblock %}
{% block header_tools %}
<input type="text" class="form-control w-25" placeholder="Search in my books" id="searchInput">
{% endblock %}

{% block content %}
{% if results %}
    {% for book in results %}
        <form action="{{ url_for('Index.remove_book') }}" method="POST">
            <input type="hidden" name="google_book_id" value="{{book.google_book_id}}">
            <a href="{{ url_for('Index.book_detail', google_book_id=book.google_book_id) }}" class="text-decoration-none text-dark">
            <div class="card col-md-12 d-flex gap-2 flex-row align-items-center my-3 py-3 bg-light hover px-3 book-item">
               
                <img style="width: 150px;height: 150px;object-fit:contain;border-radius: 5px;" src="{{ book.thumbnail }}">
                <div class="d-flex flex-column gap-2" style="max-width: max(40vw, 60%);">
                <h3 style="overflow: hidden;text-overflow: ellipsis; white-space: nowrap;">{{ book.title }}</h3>
                <p class="mb-0">{{ book.authors }}</p>
                <p class="mb-0 text-muted">{{ book.publishedDate }}</p>

                {% if book.page_count and book.page_count > 0 %}
                    <div class="mt-1">
                        <div class="progress" style="height: 8px; width: 100%; min-width: 150px;">
                            <div class="progress-bar bg-success" role="progressbar" 
                                style="width: {{ (book.current_page / book.page_count) * 100 }}%">
                            </div>
                        </div>
                        <small class="text-muted" style="font-size: 0.85rem;">
                            {{ book.current_page }} de {{ book.page_count }} p√°ginas ({{ ((book.current_page / book.page_count) * 100) | round | int }}%)
                        </small>
                    </div>
                {% endif %}
                </div>
                <button type="submit" class="btn btn-danger ms-auto me-3">Remove from Shelf</button>
            </div>
            </a>
        </form>
    {% endfor %}
{% else %}
    <div class="d-flex align-items-center justify-content-center flex-column my-5">
        <svg width="64px" height="64px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M4 19V6.2C4 5.0799 4 4.51984 4.21799 4.09202C4.40973 3.71569 4.71569 3.40973 5.09202 3.21799C5.51984 3 6.0799 3 7.2 3H16.8C17.9201 3 18.4802 3 18.908 3.21799C19.2843 3.40973 19.5903 3.71569 19.782 4.09202C20 4.51984 20 5.0799 20 6.2V17H6C4.89543 17 4 17.8954 4 19ZM4 19C4 20.1046 4.89543 21 6 21H20M9 7H15M9 11H15M19 17V21" stroke="#6d7a66" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
        <h2 style="color: #6d7a66;">Nenhum resultado encontrado.</h2>
    </div>
{% endif %}
{% endblock %}